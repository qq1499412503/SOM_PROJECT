{% load static %}

<html id="html">
  <head>
    <title>Visualization</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link href="{% static 'css/axure_rp_page.css' %}" type="text/css" rel="stylesheet"/>
    <link href="{% static 'css/styles.css' %}" type="text/css" rel="stylesheet"/>
    <link href="{% static 'css/fstyles.css' %}" type="text/css" rel="stylesheet"/>
    <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
    <script src="{% static 'js/axure/axQuery.js' %}"></script>
    <script src="{% static 'js/axure/globals.js' %}"></script>
    <script src="{% static 'js/axutils.js' %}"></script>
    <script src="{% static 'js/axure/annotation.js' %}"></script>
    <script src="{% static 'js/axure/axQuery.std.js' %}"></script>
    <script src="{% static 'js/axure/doc.js' %}"></script>
    <script src="{% static 'js/messagecenter.js' %}"></script>
    <script src="{% static 'js/axure/events.js' %}"></script>
    <script src="{% static 'js/axure/recording.js' %}"></script>
    <script src="{% static 'js/axure/action.js' %}"></script>
    <script src="{% static 'js/axure/expr.js' %}"></script>
    <script src="{% static 'js/axure/geometry.js' %}"></script>
    <script src="{% static 'js/axure/flyout.js' %}"></script>
    <script src="{% static 'js/axure/model.js' %}"></script>
    <script src="{% static 'js/axure/repeater.js' %}"></script>
    <script src="{% static 'js/axure/sto.js' %}"></script>
    <script src="{% static 'js/axure/utils.temp.js' %}"></script>
    <script src="{% static 'js/axure/variables.js' %}"></script>
    <script src="{% static 'js/axure/drag.js' %}"></script>
    <script src="{% static 'js/axure/move.js' %}"></script>
    <script src="{% static 'js/axure/visibility.js' %}"></script>
    <script src="{% static 'js/axure/style.js' %}"></script>
    <script src="{% static 'js/axure/adaptive.js' %}"></script>
    <script src="{% static 'js/axure/tree.js' %}"></script>
    <script src="{% static 'js/axure/init.temp.js' %}"></script>
    <script src="{% static 'js/axure/legacy.js' %}"></script>
    <script src="{% static 'js/axure/viewer.js' %}"></script>
    <script src="{% static 'js/axure/math.js' %}"></script>
    <script src="{% static 'js/axure/jquery.nicescroll.min.js' %}"></script>
    <script src="{% static 'js/document.js' %}"></script>
    <script src="{% static 'js/data.js' %}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
  window.onload=function (){
    var width = $(window).width();
    var height = $(window).height();
    var scaleX = width/1920;
    var scaleY = height/940;
    document.getElementById('html').style.transform = "scale("+scaleX+","+scaleY+")";
    document.getElementById('html').style.transformOrigin ='0 top';
  }

</script>
<style>
  div.tooltip {
    position: absolute;
    text-align: center;
    width: min-content;
    height: min-content;
    padding: 2px;
    font: 12px sans-serif;
    background: lightsteelblue;
    border: 0px;
    border-radius: 8px;
    pointer-events: none;
}

</style>
  </head>

  <body>
    <div id="base" class="">

      <!-- Unnamed (Rectangle) -->
      <div id="m0" class="ax_default box_1">
        <div id="m0_div" class=""></div>
        <div id="m0_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Group) -->
      <div id="m1" class="ax_default" data-left="0" data-top="0" data-width="1600" data-height="900">

        <!-- Unnamed (Group) -->
        <div id="m2" class="ax_default" data-left="0" data-top="0" data-width="1600" data-height="900">

          <!-- Unnamed (Rectangle) -->
          <div id="m3" class="ax_default box_1">
            <div id="m3_div" class=""></div>
            <div id="m3_text" class="text " style="display:none; visibility: hidden">
              <p></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="m4" class="ax_default box_1">
        <div id="m4_div" class=""></div>
        <div id="m4_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Image) -->
      <div id="m5" class="ax_default image">
        <a href="{% url 'user:profile'%}">
        <img id="m5_img" class="img " src="/media/image/u5.svg"/>
          </a>
        <div id="m5_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="m6" class="ax_default heading_3">
        <div id="m6_div" class=""></div>
        <div id="m6_text" class="text ">
          <p><span>Parameters</span></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <form id="upload_form" enctype="multipart/form-data" method="post">
          {% csrf_token %}
<!--          {{ form.upload }}-->
      <div id="m7" class="ax_default button" onclick="document.getElementById('upload').click();" style="cursor: pointer;">
        <div id="m7_div" class=""></div>
        <div id="m7_text" class="text ">

         <input type="file" name="data" id="upload" onchange="document.getElementById('m16_input').value=document.getElementById('upload').files[0].name" accept=".txt, .dat" hidden/>
         <label style="cursor: pointer;">Choose file</label>

        </div>
      </div>
</form>


      <!-- Unnamed (Rectangle) -->
      <div id="m8" class="ax_default heading_3">
        <div id="m8_div" class=""></div>
        <div id="m8_text" class="text ">
          <p><span>Data</span></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="m9" class="ax_default button"  onclick="document.getElementById('update_log_button').click();" style="cursor: pointer;">
        <div id="m9_div" class=""></div>
        <div id="m9_text" class="text ">
          <input value="train" name="train"  id="update_log_button" type="button" onclick="query('111')" hidden/>
          <label style="cursor: pointer;">train</label>
        </div>
      </div>

      <!-- Unnamed (Shape) -->
      <div id="m10" class="ax_default icon">
        <a href="{% url 'publish:list' %}">
        <img id="m10_img" class="img " src="/media/image/u10.svg"/>
          </a>
        <div id="m10_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="m11" class="ax_default button" onclick="pre_save()" style="cursor: pointer">
        <div id="m11_div" class=""></div>
        <div id="m11_text" class="text ">
          <p><span>Save</span></p>
        </div>
      </div>



      <script>
        function exit_save(){
          $('#mv53').css('visibility','hidden');
        }

      </script>

 <script>
	function save_map(){
	if(document.getElementById('vis_name').value===''){
	alert("please enter project name before save");
	}else{
	save_maps();	
	}
		
	}
      function save_maps(){

      $.ajax({
      type: "post",
      url: "{% url 'som:save_map' %}",
      dataType: "json",
      data: JSON.stringify({user_id: "{{ user.id }}",data_id:"{{ data_id }}",
        vis_name:document.getElementById('vis_name').value,
        author:document.getElementById('author').value,
        description:document.getElementById('description').value,
        min_color:document.getElementById('color').value,
        max_color:document.getElementById('color_max').value
      }),
      complete: function(){
              $('#mv53').css('visibility','hidden');
          },
      success: function as(raw_data) {
            alert("Saved Successfully");

      },
      error: function() {
            alert("Failure to access, please refresh the page");
            }
      })
      ;
      }



      </script>

      <script>
	      
function save_and_publish(){
	if(document.getElementById('vis_name').value===''){
	alert("please enter project name before save");
	}else{
	save_and_publishs();	
	}
		
	}
      function save_and_publishs(){

      $.ajax({
      type: "post",
      url: "{% url 'som:save_and_publish' %}",
      dataType: "json",
      data: JSON.stringify({user_id: "{{ user.id }}",data_id:"{{ data_id }}",
        vis_name:document.getElementById('vis_name').value,
        author:document.getElementById('author').value,
        description:document.getElementById('description').value,
        min_color:document.getElementById('color').value,
        max_color:document.getElementById('color_max').value
      }),
      complete: function(){
              $('#mv53').css('visibility','hidden');
          },
      success: function as(raw_data) {
            alert("Saved Successfully");

      },
      error: function() {
            alert("Failure to access, please refresh the page");
            }
      })
      ;
      }



      </script>

      <!-- Unnamed (Rectangle) -->
      <div id="m12" class="ax_default heading_3">
        <div id="m12_div" class=""></div>
        <div id="m12_text" class="text ">
          {% if user.is_authenticated %}
          <p><span>Welcome, {{ user.get_username }},&nbsp;&nbsp;</span><a href="{% url 'som:som_model' %}">New Project,</a>&nbsp;&nbsp;<a href="{% url 'user:logout' %}">logout</a></p>
        {% endif %}
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="m13" class="ax_default heading_1">
        <div id="m13_div" class=""></div>
        <div id="m13_text" class="text ">
          <p><span>Self-Organizing Map</span></p>
        </div>
      </div>

      <!-- Unnamed (Image) -->
      <div id="m14" class="ax_default image" style="background-color: #e5b367">
        <img id="m14_img" class="img " style="visibility: hidden" src="/media/image/loading.gif"/>
        <div id="m14_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>



      <!-- Unnamed (Rectangle) -->
      <div id="m15" class="ax_default button"  onclick="upload()" style="cursor: pointer;">
        <div id="m15_div" class=""></div>
        <div id="m15_text" class="text ">
          <input type="submit" id="submit_upload" form="upload_form" hidden/>
          <label style="cursor: pointer;">upload</label>
        </div>
      </div>

      <script>
        function upload(){
          if (document.getElementById('m16_input').value === ''){
            alert('please select file before upload');
          }
          else{
            document.getElementById('submit_upload').click();
          }
        }
      </script>

      <!-- Unnamed (Text Field) -->
      <div id="m16" class="ax_default text_field">
        <img id="m16_img" class="img " src="/media/image/u16.svg"/>
        <input id="m16_input" type="text" class="m16_input" value="{{ upload_msg }}"/>
      </div>

      <!-- Close Icon (Shape) -->
      <div id="m17" class="ax_default icon ax_default_hidden" data-label="Close Icon" style="display:none; visibility: hidden">
        <img id="m17_img" class="img " src="/media/image/close_icon_u17.svg"/>
        <div id="m17_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
      </div>

      <!-- Unnamed (Menu) -->
      <div id="m18" class="ax_default ax_default_hidden" style="display:none; visibility: hidden">
        <img id="m18_menu" class="img " src="/media/image/u18_menu.png" alt="u18_menu"/>

        <!-- Unnamed (Table) -->
        <div id="m19" class="ax_default">

          <!-- Unnamed (Menu Item) -->
          <div id="m20" class="ax_default menu_item">
            <img id="m20_img" class="img " src="/media/image/u20.png"/>
            <div id="m20_text" class="text ">
              <p><span>Profile</span></p>
            </div>
          </div>

          <!-- Unnamed (Menu Item) -->
          <div id="m21" class="ax_default menu_item">
            <img id="m21_img" class="img " src="/media/image/u20.png"/>
            <div id="m21_text" class="text ">
              <p><span>Log in</span></p>
            </div>
          </div>

          <!-- Unnamed (Menu Item) -->
          <div id="m22" class="ax_default menu_item">
            <img id="m22_img" class="img " src="/media/image/u22.png"/>
            <div id="m22_text" class="text ">
              <p><span>Log out</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Unnamed (Table) -->
      <div id="m23" class="ax_default">

        <!-- Unnamed (Table Cell) -->
        <div id="m24" class="ax_default table_cell">
          <img id="m24_img" class="img " src="/media/image/u24.png"/>
          <div id="m24_text" class="text " style="font-weight: bold;">
            <p><span>name</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m25" class="ax_default table_cell">
          <img id="m25_img" class="img " src="/media/image/u25.png"/>
          <div id="m25_text" class="text ">
            <p><span id="file_name">{{ name }}</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m26" class="ax_default table_cell">
          <img id="m26_img" class="img " src="/media/image/u26.png"/>
          <div id="m26_text" class="text " style="font-weight: bold;">
            <p><span>attribute</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m27" class="ax_default table_cell">
          <img id="m27_img" class="img " src="/media/image/u27.png"/>
          <div id="m27_text" class="text ">
            <p><span>{{ attribute }}</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m28" class="ax_default table_cell">
          <img id="m28_img" class="img " src="/media/image/u28.png"/>
          <div id="m28_text" class="text " style="font-weight: bold;">
            <p><span>size</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m29" class="ax_default table_cell">
          <img id="m29_img" class="img " src="/media/image/u29.png"/>
          <div id="m29_text" class="text ">
            <p><span>{{ size }}</span></p>
          </div>
        </div>
      </div>


      <!-- Unnamed (Table) -->
      <div id="m30" class="ax_default">

        <!-- Unnamed (Table Cell) -->
        <div id="m31" class="ax_default table_cell">
          <img id="m31_img" class="img " src="/media/image/u31.png"/>
          <div id="m31_text" class="text " style="font-weight: bold;">
            <p><span>Parameter</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m32" class="ax_default table_cell">
          <img id="m32_img" class="img " src="/media/image/u32.png"/>
          <div id="m32_text" class="text " style="font-weight: bold;">
            <p><span>Value</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m33" class="ax_default table_cell">
          <img id="m33_img" class="img " src="/media/image/u33.png"/>
          <div id="m33_text" class="text " style="font-weight: bold;">
            <p><span>x</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m34" class="ax_default table_cell">
          <img id="m34_img" class="img " src="/media/image/u34.png"/>
          <div id="m34_text" class="text " style="visibility: visible">
            <input type="text" id="x" name="x" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="enter number of x here (int)">
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m35" class="ax_default table_cell">
          <img id="m35_img" class="img " src="/media/image/u35.png"/>
          <div id="m35_text" class="text " style="font-weight: bold;">
            <p><span>y</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m36" class="ax_default table_cell">
          <img id="m36_img" class="img " src="/media/image/u36.png"/>
          <div id="m36_text" class="text " style="visibility: visible">
            <input type="text" id="y" name="y" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="enter number of y here (int)">
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m37" class="ax_default table_cell">
          <img id="m37_img" class="img " src="/media/image/u35.png"/>
          <div id="m37_text" class="text " style="font-weight: bold;">
            <p><span>input_len</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m38" class="ax_default table_cell">
          <img id="m38_img" class="img " src="/media/image/u36.png"/>
          <div id="m38_text" class="text " style="visibility: visible">
            <input type="text" id="len" name="len" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="auto detect" value="{{ attribute }}" disabled>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m39" class="ax_default table_cell">
          <img id="m39_img" class="img " src="/media/image/u35.png"/>
          <div id="m39_text" class="text " style="font-weight: bold;">
            <p><span>sigma</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m40" class="ax_default table_cell">
          <img id="m40_img" class="img " src="/media/image/u36.png"/>
          <div id="m40_text" class="text " style="visibility: visible">
            <input type="text" id="sigmas" name="sigmas" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="default value: 1.5 (double)">
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m41" class="ax_default table_cell">
          <img id="m41_img" class="img " src="/media/image/u35.png"/>
          <div id="m41_text" class="text " style="font-weight: bold;">
            <p><span>learning_rate</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m42" class="ax_default table_cell">
          <img id="m42_img" class="img " src="/media/image/u36.png"/>
          <div id="m42_text" class="text " style="visibility: visible">
            <input type="text" id="LR" name="LR" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="default value: 0.05 (double)">
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m43" class="ax_default table_cell">
          <img id="m43_img" class="img " src="/media/image/u35.png"/>
          <div id="m43_text" class="text " style="font-weight: bold;">
            <p><span>Iteration number</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m44" class="ax_default table_cell">
          <img id="m44_img" class="img " src="/media/image/u36.png"/>
          <div id="m44_text" class="text " style="visibility: visible">
            <input type="text" id="Iteration" name="Iteration" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="default value: 1000 (int)">
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m45" class="ax_default table_cell">
          <img id="m45_img" class="img " src="/media/image/u35.png"/>
          <div id="m45_text" class="text " style="font-weight: bold;">
            <p><span>neighborhood</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m46" class="ax_default table_cell">
          <img id="m46_img" class="img " src="/media/image/u36.png"/>
          <div id="m46_text" class="text " style="visibility: visible">
            {% with 'gaussian mexican_hat bubble triangle' as neighbour_list %}
            <select class="form-control" id="neighbour_option" name="class_name" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align-last:center;">
                {% for item in neighbour_list.split %}
                    <option>{{ item }}</option>
                {% endfor %}
            </select>
            {% endwith %}
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m47" class="ax_default table_cell">
          <img id="m47_img" class="img " src="/media/image/u35.png"/>
          <div id="m47_text" class="text " style="font-weight: bold;">
            <p><span>topology</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m48" class="ax_default table_cell">
          <img id="m48_img" class="img " src="/media/image/u36.png"/>
          <div id="m48_text" class="text " style="visibility: visible">
            {% with 'hexagonal' as topology_list %}
            <select class="form-control" id="topology_option" name="class_name" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align-last:center;">
                {% for item in topology_list.split %}
                    <option>{{ item }}</option>
                {% endfor %}
            </select>
            {% endwith %}
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m49" class="ax_default table_cell">
          <img id="m49_img" class="img " src="/media/image/u35.png"/>
          <div id="m49_text" class="text " style="font-weight: bold;">
            <p><span>activation_distance</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m50" class="ax_default table_cell">
          <img id="m50_img" class="img " src="/media/image/u36.png"/>
          <div id="m50_text" class="text " style="visibility: visible">
            {% with 'euclidean cosine manhattan chebyshev' as activation_list %}
            <select class="form-control" id="activation_option" name="class_name" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align-last:center;">
                {% for item in activation_list.split %}
                    <option>{{ item }}</option>
                {% endfor %}
            </select>
            {% endwith %}
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m51" class="ax_default table_cell">
          <img id="m51_img" class="img " src="/media/image/u51.png"/>
          <div id="m51_text" class="text " style="font-weight: bold;">
            <p><span>random_seed</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="m52" class="ax_default table_cell">
          <img id="m52_img" class="img " src="/media/image/u52.png"/>
          <div id="m52_text" class="text " style="visibility: visible">
            <input type="text" id="random_seed" name="random_seed" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="default value: None (double)">
          </div>
        </div>
      </div>

            <div id="u60" class="ax_default box_1" style="visibility: hidden">
        <div id="u60_div" class=""></div>
        <div id="u60_text" class="text " style="display:none; visibility: hidden">
          <p></p>
        </div>
              <div id="u54" class="ax_default table_cell">
          <img id="u54_img" class="img " src="/media/image/ua54.png"/>
          <div id="u54_text" class="text " style="display:none; visibility: hidden">
            <p></p>
          </div>
        </div>

       <div id="u55" class="ax_default table_cell">
          <img id="u55_img" class="img " src="/media/image/ua55.png"/>
          <div id="u55_text" class="text ">
            <p><span>Value</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="u56" class="ax_default table_cell">
          <img id="u56_img" class="img " src="/media/image/ua56.png"/>
          <div id="u56_text" class="text ">
            <p><span>Color min->max</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="u57" class="ax_default table_cell">
          <img id="u57_img" class="img " src="/media/image/ua57.png"/>
          <div id="u57_text" class="text " >
            <div id="min_color" STYLE="float:left;left:0px;width:50%;height:100%;position: relative;">
            <select class="form-control" id="color" name="color" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align-last:center;" onchange="change_color()">
              <option>white</option>
              <option disabled>blue</option>
              <option>red</option>
              <option>green</option>
              <option>purple</option>

            </select>
          </div>
            <div id="max_color" STYLE="float:right;right:0px;width:50%;height:100%;position: relative;">
            <select class="form-control" id="color_max" name="color_max" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align-last:center;" onchange="change_color()">
              <option disabled>white</option>
              <option>blue</option>
              <option>red</option>
              <option>green</option>
              <option>purple</option>
            </select>
          </div>
          </div>

        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="u58" class="ax_default table_cell">
          <img id="u58_img" class="img " src="/media/image/ua58.png"/>
          <div id="u58_text" class="text ">
            <p><span>Font size</span></p>
          </div>
        </div>

        <!-- Unnamed (Table Cell) -->
        <div id="u59" class="ax_default table_cell">
          <img id="u59_img" class="img " src="/media/image/ua59.png"/>
          <div id="u59_text" class="text ">
            <input type="text" id="font_size" name="font_size" style="width: 100%;height:100%;background-color:#D7E2CF;border:0;text-align: center;" placeholder="default value: None (int)" onchange="change_font()">
          </div>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->



      <!-- Unnamed (Rectangle) -->
      <div id="u61" class="ax_default box_1" style="visibility: hidden">

      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u62" class="ax_default box_1" style="visibility: hidden">
        <div id="u62_div" class=""></div>
        <div id="u62_text" class="text " >
          <p></p>
        </div>
      </div>

      </div>

        <!-- save button -->
        <div id="mv53" style="background-color:#FFFFFF;border: thin solid black;visibility:hidden;">
        <div id="mv53_state0" class="panel_state" data-label="State 1" style="">
          <div id="mv53_state0_content" class="panel_state_content">

            <!-- Unnamed (Rectangle) -->
            <div id="m54" class="ax_default heading_1">
              <div id="m54_div" class=""></div>
              <div id="m54_text" class="text ">
                <p><span>Save as</span></p>
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m55" class="ax_default primary_button" style="cursor: pointer;" onclick="save_and_publish()">
              <div id="m55_div" class="" tabindex="0"></div>
              <div id="m55_text" class="text ">
                <p><span>Save and Publish</span></p>
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m56" class="ax_default primary_button" onclick="save_map()" style="cursor: pointer;">
              <div id="m56_div" class=""></div>
              <div id="m56_text" class="text ">
                <p><span>Save</span></p>
              </div>
            </div>

            <div id="m561" style="left:600px;position:absolute;color: #0000FF;cursor: pointer;" onclick="exit_save()">
              <p><span>Exit</span></p>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m57" class="ax_default box_1">
              <div id="m57_div" class=""></div>
              <div id="m57_text" class="text ">
                <input id="vis_name" type="text" style="width:100%;height:100%;border:0" placeholder="enter project name">
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m58" class="ax_default heading_3">
              <div id="m58_div" class=""></div>
              <div id="m58_text" class="text ">
                <p><span>Enter your visualization name: </span></p>
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m59" class="ax_default box_1">
              <div id="m59_div" class=""></div>
              <div id="m59_text" class="text ">
                <input id="author" type="text" style="width:100%;height:100%;border:0" placeholder="enter author name">
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m60" class="ax_default heading_3">
              <div id="m60_div" class=""></div>
              <div id="m60_text" class="text ">
                <p><span>Enter your name: </span></p>
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m61" class="ax_default box_1">
              <div id="m61_div" class=""></div>
              <div id="m61_text" class="text ">
                <input id="description" type="text" style="width:100%;height:100%;border:0" placeholder="enter description">
              </div>
            </div>

            <!-- Unnamed (Rectangle) -->
            <div id="m62" class="ax_default heading_3">
              <div id="m62_div" class=""></div>
              <div id="m62_text" class="text ">
                <p><span>Enter your description: </span></p>
              </div>
            </div>
          </div>
        </div>
      </div>


      <!--      <script src="{% static 'js/sigma.js-1.2.1/plugins/sigma.parsers.json/sigma.parsers.json.js' %}"></script>-->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
<!--    <script src="http://benschmidt.org/colorbar/colorbar.js"></script>-->
<!--    <script src="{% static 'js/cb.js' %}"></script>-->
    <script src="https://d3js.org/d3-color.v2.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v2.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v2.min.js"></script>
    <script type="text/javascript">


var colorScale1;
      var data = null;
      function setValue(val){
          data=val;
      }
      function getValue(){
          return data;
      }

      function cleanValue(){
          data = null;
      }

function pre_save(){
        if (getValue() === null){
          alert("please training the map before save");
        }else{
      $('#mv53').css('visibility','visible');
        }

}


function col(){
        if (parseInt(document.getElementById('x').value) > 0){
          return parseInt(document.getElementById('x').value);
        }else{
          return 30;
        }

}

function row(){
        if (parseInt(document.getElementById('y').value) > 0){
          return parseInt(document.getElementById('y').value);
        }else{
          return 20;
        }

}

var svg = d3.select("#m14").append("svg")
                .attr("width", document.querySelector('#m14').offsetWidth)
                .attr("height", document.querySelector('#m14').offsetHeight),
    margin = {top: 10, right: 440, bottom: 10, left: 20},
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height") - margin.top - margin.bottom,
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")"),
    // l = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")"),
    a = d3.select("body").append("div").classed('tooltip', true).style("visibility", "hidden");

    var MapColumns = col(),
        MapRows = row();

    var hexRadius = d3.min([width/((MapColumns + 0.5) * Math.sqrt(3)),
                height/((MapRows + 1/3) * 1.5)]);
    width = MapColumns*hexRadius*Math.sqrt(3);
    height = MapRows*1.5*hexRadius+0.5*hexRadius;
    var hexbin = d3.hexbin()
        .radius(hexRadius)



function get_point(){
    var points = [];
    for (var i = 0; i < MapRows; i++) {
        for (var j = 0; j < MapColumns; j++) {
            var x = hexRadius * j * Math.sqrt(3)
            if(i%2 === 1) x += (hexRadius * Math.sqrt(3))/2
            if((i-2)%4===0) x += (hexRadius * Math.sqrt(3))
            var y = hexRadius * i * 1.5
            var color =  getValue()['nodes'][i][j]
            var weights = getValue()['weights'][i][j]
            var label = getValue()['label'][j][i]
            var color_value = getValue()['color_value'][i][j]
            // points.push([x,y,color])
          points.push({"x": x,"y": y,"color": color,"weights":weights,"label":label,"cv":color_value})
        }
    }
    return points;
}


    var _zoom = d3.zoom()
      .scaleExtent([.5, 20])
      .extent([[0, 0], [width, height]])
      .on("zoom", updateChart);

function getTranslation(transform) {
  var g = document.createElementNS("http://www.w3.org/2000/svg", "g");
  g.setAttributeNS(null, "transform", transform);
  var matrix = g.transform.baseVal.consolidate().matrix;
  return [matrix.e, matrix.f];
}


    var _drag = d3.drag()
      .on("drag",moveMap);


    g.append("clipPath")
        .attr("id", "clip")
      .append("rect")
        .attr("width", width)
        .attr("height", height);

function right(d){
  // var d = get_point();
  var dm = Math.max.apply(Math, d.map(function(d) { return d.x; }));
  var target = [];
  for (var i = 0; i < d.length; i++){
    // alert(i);
    if (parseInt(d[i].x) !== parseInt(dm)){
      target.push({"x": d[i].x+hexRadius * Math.sqrt(3)/2,"y": d[i].y,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
    }else{
    target.push({"x": d[i].x-(hexRadius *(MapColumns-1)* Math.sqrt(3))-hexRadius * Math.sqrt(3)/2,"y": d[i].y,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
    }
  }
  return target
  }

  function left(d){
  // var d = get_point();
  var dm = Math.min.apply(Math, d.map(function(d) { return d.x; }));
  var target = [];
  for (var i = 0; i < d.length; i++){
    // alert(i);
    if (parseInt(d[i].x) !== parseInt(dm)){
      target.push({"x": d[i].x-hexRadius * Math.sqrt(3)/2,"y": d[i].y,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
      // alert(d[i].x);
    }else{
      target.push({"x": d[i].x+(hexRadius *(MapColumns-1)* Math.sqrt(3))+hexRadius * Math.sqrt(3)/2,"y": d[i].y,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
    }
  }

  return target

}



function up(d){
  // var d = get_point();
  var dm = Math.min.apply(Math, d.map(function(d) { return d.y; }));
  var target = [];
  for (var i = 0; i < d.length; i++){
    // alert(i);
    if (d[i].y !== dm){
      target.push({"x": d[i].x,"y": d[i].y - hexRadius * 1.5,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
      // alert(d[i].x);
    }else{
      target.push({"x": d[i].x,"y": d[i].y + hexRadius * (MapRows-1) * 1.5,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
    }
  }

  return target

}


function down(d){
  // var d = get_point();
  var dm = Math.max.apply(Math, d.map(function(d) { return d.y; }));
  var target = [];
  for (var i = 0; i < d.length; i++){
    // alert(i);
    if (d[i].y !== dm){
      target.push({"x": d[i].x,"y": d[i].y + hexRadius * 1.5,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
      // alert(d[i].x);
    }else{
      target.push({"x": d[i].x,"y": 0,"color": d[i].color,"weights":d[i].weights,"label":d[i].label,"cv":d[i].cv});
    }
  }

  return target

}


function update(data){
      g.selectAll("path")

            .remove();

      g.selectAll("text").remove();
    ///


      g.append("g")
      .attr("class", "hexagon")
      .attr("clip-path", "url(#clip)")
      .selectAll(".hexagon")
      .data(data)
      .enter().append("path")
      .attr("d", function (d) {
		return "M" + d.x + "," + d.y + hexbin.radius(hexRadius).hexagon();
	})
         .attr("stroke", function (d,i) {
		return "#e5b367";
	})
      .attr("stroke-width", "1px")
      .attr("fill", function(d){ return colorScale1(d.cv); })
              // .attr("transform","translate("+(width1)/24+","+(height1)/24+")")
              .attr("transform","translate("+0+","+0+")")
      .call(_drag)
        .on('mouseover', mouseOver);

          g.append("g")
      .attr("class", "hexagon")
      .attr("clip-path", "url(#clip)")
      .selectAll("labels")
      .data(data)
      .enter()
      .append("text")
                  .attr("transform","translate("+0+","+0+")")
              // .attr("transform","translate("+(width1)/24+","+(height1)/24+")")
        .attr("x", function(d){return d.x})
        .attr("y", function(d){return d.y})
        .text(function(d){ return d.label; })
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .style("font-size", 10)
        .style("fill", "black");

}
var init_dt;




var initx = 34.78;
var w;
var h;
var inity = 31.03;
// var dx =0;
// var lw =1;
function moveMap(d){
  var translate = getTranslation(d3.select(this).attr("transform"));
  var dx = d3.event.dx;
  var dy = d3.event.dy;
  // dx = Math.max(Math.min(-w),Math.min(-w),dx);
  // dx = Math.min(Math.max(w),Math.max(w),dx);
  // dy = Math.max(Math.min(-h),Math.min(-h),dy);
  // dy = Math.min(Math.max(h),Math.max(h),dy);
    dx = Math.max(Math.min(-1),Math.min(-1),dx);
  dx = Math.min(Math.max(1),Math.max(1),dx);
  dy = Math.max(Math.min(-1),Math.min(-1),dy);
  dy = Math.min(Math.max(1),Math.max(1),dy);
      x = dx+translate[0];
      y = dy+translate[1];



if (dx>0){
  init_dt = right(init_dt);
  update(init_dt);
}
if (dx<0){
  init_dt = left(init_dt);
  update(init_dt);
}
if (dy>0){
  init_dt = down(init_dt);
  update(init_dt);
}
if (dy<0){
  init_dt = up(init_dt);
  update(init_dt);
}
  }




    function updateChart() {
      // var newX = d3.event.transform.rescaleX(x);
      // var newY = d3.event.transform.rescaleY(y);
      // // var currentZoomScale = d3.event.transform.k;
      // xAxis.call(d3.axisBottom(newX));
      // yAxis.call(d3.axisLeft(newY));
      g.selectAll("path")
      .on('dblclick.zoom', false)
      .attr("d", function (d) {
		return "M" + d.x + "," + (height-d.y) + hexbin.radius(hexRadius).hexagon();
	});
    }

    function mouseOver(d, i) {
    d3.select(this).classed('over', true);
    d3.select("#u62_text").text(d.weights );
    // ' (' + parseInt(d.x) + ',' + parseInt(d.y) + ')'
    // a.style("visibility", "visible");

}
function mouseMove(d, i) {
    a.style('top', (d3.event.pageY - 10) + 'px').style('left', (d3.event.pageX + 10) + 'px');
}
function mouseOut(d, i) {
    d3.select(this).classed('over', false);
    a.style("visibility", "hidden");
}

function continuous(selector_id, colorscale) {
  d3.select('canvas').remove();
  d3.select(selector_id).select('svg').remove();
  var legendheight = 588,
      legendwidth = 50,
      margin = {top: 10, right: 25, bottom: 10, left: 2};

  var canvas = d3.select(selector_id)
    .style("height", legendheight + "px")
    .style("width", legendwidth + "px")
    .append("canvas")
    .attr("height", legendheight - margin.top - margin.bottom)
    .attr("width", 1)
    .style("height", (legendheight - margin.top - margin.bottom) + "px")
    .style("width", (legendwidth - margin.left - margin.right) + "px")
    .style("border", "1px solid #000")
    .style("position", "absolute")
    .style("top", (margin.top) + "px")
    .style("left", (margin.left) + "px")
    .node();

  var ctx = canvas.getContext("2d");

  var legendscale = d3.scaleLinear()
    .range([1, legendheight - margin.top - margin.bottom])
    .domain(colorscale.domain());

  // image data hackery based on http://bl.ocks.org/mbostock/048d21cf747371b11884f75ad896e5a5
  var image = ctx.createImageData(1, legendheight);
  d3.range(legendheight).forEach(function(i) {
    var c = d3.rgb(colorscale(legendscale.invert(i)));
    image.data[4*i] = c.r;
    image.data[4*i + 1] = c.g;
    image.data[4*i + 2] = c.b;
    image.data[4*i + 3] = 255;
  });
  ctx.putImageData(image, 0, 0);

  // A simpler way to do the above, but possibly slower. keep in mind the legend width is stretched because the width attr of the canvas is 1
  // See http://stackoverflow.com/questions/4899799/whats-the-best-way-to-set-a-single-pixel-in-an-html5-canvas
  /*
  d3.range(legendheight).forEach(function(i) {
    ctx.fillStyle = colorscale(legendscale.invert(i));
    ctx.fillRect(0,i,1,1);
  });
  */

  var legendaxis = d3.axisRight()
    .scale(legendscale)
    .tickSize(6)
    .ticks(8);

  var svg = d3.select(selector_id)
    .append("svg")
    .attr("height", (legendheight) + "px")
    .attr("width", (legendwidth) + "px")
    .style("position", "absolute")
    .style("left", "0px")
    .style("top", "0px")

  svg
    .append("g")
    .attr("class", "axis")
    .attr("transform", "translate(" + (legendwidth - margin.left - margin.right + 3) + "," + (margin.top) + ")")
    .call(legendaxis);

  d3.select('defs').remove();
};



      function querys(UID){

      $.ajax({
      type: "post",
      url: "{% url 'som:user_query_info' %}",
      dataType: "json",
      data: JSON.stringify({user_id: "UID",data_id:"{{ data_id }}",
        x:document.getElementById('x').value,
        y:document.getElementById('y').value,
        len:document.getElementById('len').value,
        sigmas:document.getElementById('sigmas').value,
        lr:document.getElementById('LR').value,
        iteration:document.getElementById('Iteration').value,
        neighbour:document.getElementById('neighbour_option').value,
        topology:document.getElementById('topology_option').value,
        activation:document.getElementById('activation_option').value,
        random:document.getElementById('random_seed').value}),
      beforeSend: function(){

              $('#m14_img').css('visibility','visible');
              $('#u60').css('visibility','hidden');
              $('#u61').css('visibility','hidden');
              $('#u62').css('visibility','hidden');
              document.getElementById('color').value = 'white'
              document.getElementById('color_max').value = 'blue'
              document.getElementById('font_size').value = 10
          },
      complete: function(){
              $('#m14_img').css('visibility','hidden');
              $('#u60').css('visibility','visible');
              $('#u61').css('visibility','visible');
              $('#u62').css('visibility','visible');
          },
      success: function as(raw_data) {
      var scale_rw;
      var scale_rh;
      var new_w;
      var new_h;
      setValue(raw_data);
      svg.remove();
      MapColumns = col()*2;
      MapRows = row()*2;

      hexRadius = d3.min([width/((MapColumns + 0.5) * Math.sqrt(3)),
      height/((MapRows + 1/3) * 1.5)]);
      width1 = MapColumns*hexRadius*Math.sqrt(3);
      height1 = MapRows*1.5*hexRadius+0.5*hexRadius;
      if (MapColumns < MapRows){
        scale_rw = (MapColumns/MapRows)*800/width1;
        scale_rh = 780/height1;
        // new_w = (MapColumns/MapRows)*800;
        // new_h = 780;
      }else if (MapColumns === MapRows){
        scale_rw = 800/width1;
        scale_rh = 780/height1;
        // new_w = 800;
        // new_h = 780;
      }else{
        scale_rw = 800/width1;
        scale_rh = (MapRows/MapColumns)*780/height1;
        // new_w = 800;
        // new_h = (MapRows/MapColumns)*780;
      }
      svg = d3.select("#m14").append("svg")
      .attr("width", document.querySelector('#m14').offsetWidth)
      .attr("height", document.querySelector('#m14').offsetHeight);
      // g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      // l = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        g = svg.append("g").attr("transform", "translate(" + (margin.left+20) + "," + (margin.top+30) + ")" + "scale("+scale_rw+","+scale_rh+")");
      a = d3.select("body").append("div").classed('tooltip', true).style("visibility", "hidden");

      // alert(hexRadius * 1.5);
      // alert((new_h/((MapRows/2) *3 + 0.5))*1.5);

      // h = hexRadius  * 1.5;
      // h = (height1/(MapRows/2))/2;
      //   h = 40;
      //   h = height/((MapRows + 1/3) * 1.5);
colorScale1 = d3.scaleSequential(d3.interpolateBlues)
  .domain([0, 1]);

continuous("#u61", colorScale1);






      // alert(new_w/(MapColumns + 0.5));
      a.classed('tooltip', true);
      init_dt = get_point();

      init_dt = right(init_dt);


      // var point = get_point();
      // var point = get_point();
      // point = right(point);
      // w = 10 ;
        // w = width1/MapColumns
      g.append("clipPath")
      .attr("id", "clip")
      .append("rect")
      .attr("width", width1)
      .attr("height", height1);

      g.append("g")
      .attr("class", "hexagon")
      .attr("clip-path", "url(#clip)")
      .selectAll(".hexagon")
      .data(init_dt)
      .enter().append("path")
      .attr("d", function (d) {
		return "M" + d.x + "," + d.y + hexbin.radius(hexRadius).hexagon();
	})
         .attr("stroke", function (d,i) {
		return "#e5b367";
	})
      .attr("stroke-width", "1px")
      .attr("fill", function(d){ return colorScale1(d.cv); })
              // .attr("transform","translate("+(width1)/24+","+(height1)/24+")")
              .attr("transform","translate("+0+","+0+")")
      .call(_drag)
        .on('mouseover', mouseOver);
        // .on('mouseout', mouseOut)
        // .on('mousemove', mouseMove);

      g.append("g")
      .attr("class", "hexagon")
      .attr("clip-path", "url(#clip)")
      .selectAll("labels")
      .data(init_dt)
      .enter()
      .append("text")
              .attr("transform","translate("+0+","+0+")")
              // .attr("transform","translate("+(width1)/24+","+(height1)/24+")")
        .attr("x", function(d){return d.x})
        .attr("y", function(d){return d.y})
        .text(function(d){ return d.label; })
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .style("font-size", 10)
        .style("fill", "black");

// var element = d3.select('path').node();
// w = element.getBoundingClientRect().width/2;
w=(width1/MapColumns)/2;
h=(height1/(MapRows/2))/2;
        // h = element.getBoundingClientRect().height/2;
      },
      error: function() {
            alert("Failure to access, please refresh the page");
            }
      })
      ;
      }
      function query(UID){
        if ($("#file_name").text() ==='file not uploaded'){
          alert('please upload data before training');
        }else if ("{{ upload_msg }}" === "Not supporting given data file"){
          alert('please upload correct data file before training');
        }
        else if (document.getElementById('x').value ==='' || document.getElementById('y').value === '' ){
          alert('both x and y parameter can not be empty');
        }else if (document.getElementById('x').value < 2 && document.getElementById('y').value < 2 ){
          alert('both x and y parameter can not less than 2 at same time');
        }else{
          querys(UID);
        }
      }

      function change_font(){
      g.selectAll("text").style("font-size", document.getElementById('font_size').value);

      }

function change_color(){
      data['color_min'] = document.getElementById('color').value;
      data['color_max'] = document.getElementById('color_max').value;
    var option = document.getElementById('color_max').getElementsByTagName("option");
    for (var i = 0; i < option.length; i++) {
      option[i].disabled = option[i].value === document.getElementById('color').value;}
    var optionm = document.getElementById('color').getElementsByTagName("option");
    for (var i = 0; i < optionm.length; i++) {
      optionm[i].disabled = optionm[i].value === document.getElementById('color_max').value;}



  if (document.getElementById('color').value === 'white'){
      if (document.getElementById('color_max').value === 'blue'){
        colorScale1 = d3.scaleSequential(d3.interpolateBlues)
        .domain([0, 1]);
      }else if(document.getElementById('color_max').value === 'red'){
        colorScale1 = d3.scaleSequential(d3.interpolateReds)
        .domain([0, 1]);
      }else if(document.getElementById('color_max').value === 'green'){
        colorScale1 = d3.scaleSequential(d3.interpolateGreens)
        .domain([0, 1]);
      }else if(document.getElementById('color_max').value === 'purple'){
        colorScale1 = d3.scaleSequential(d3.interpolatePurples)
        .domain([0, 1]);
      }
  }
  else if (document.getElementById('color').value === 'blue') {
    if (document.getElementById('color_max').value === 'red') {
      colorScale1 = d3.scaleSequential(t => d3.interpolateRdBu(1 - t))
              .domain([0, 1]);
    }
    else if (document.getElementById('color_max').value === 'white') {
      colorScale1 = d3.scaleSequential().interpolator(t => d3.interpolateBlues(1 - t))
              .domain([0,1]);
    }
        else if (document.getElementById('color_max').value === 'purple') {

      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[0],"white",d3.schemeCategory10[4]]))
              .domain([0,1]);
    }
    else if (document.getElementById('color_max').value === 'green') {

      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[0],"white",d3.schemeCategory10[2]]))
              .domain([0,1]);
    }
  }
  else if (document.getElementById('color').value === 'green') {
    if (document.getElementById('color_max').value === 'red') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[2],"white",d3.schemeCategory10[3]]))
              .domain([0,1]);
    }
    else if (document.getElementById('color_max').value === 'white') {

      colorScale1 = d3.scaleSequential().interpolator(t => d3.interpolateGreens(1 - t))
              .domain([0,1]);

    }
        else if (document.getElementById('color_max').value === 'purple') {

      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[2],"white",d3.schemeCategory10[4]]))
              .domain([0,1]);

    }
    else if (document.getElementById('color_max').value === 'blue') {

      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[2],"white",d3.schemeCategory10[0]]))
              .domain([0,1]);
    }
  }
  else if (document.getElementById('color').value === 'red') {
    if (document.getElementById('color_max').value === 'green') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[3],"white",d3.schemeCategory10[2]]))
              .domain([0,1]);
    }
    else if (document.getElementById('color_max').value === 'white') {

      colorScale1 = d3.scaleSequential().interpolator(t => d3.interpolateReds(1 - t))
              .domain([0,1]);
    }
        else if (document.getElementById('color_max').value === 'purple') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[3],"white",d3.schemeCategory10[4]]))
              .domain([0,1]);
    }
    else if (document.getElementById('color_max').value === 'blue') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[3],"white",d3.schemeCategory10[0]]))
              .domain([0,1]);
    }
  }
  else if (document.getElementById('color').value === 'purple') {
    if (document.getElementById('color_max').value === 'green') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[4],"white",d3.schemeCategory10[2]]))
              .domain([0,1]);
    }
    else if (document.getElementById('color_max').value === 'white') {

      colorScale1 = d3.scaleSequential().interpolator(t => d3.interpolatePurples(1 - t))
              .domain([0,1]);
    }
        else if (document.getElementById('color_max').value === 'red') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[4],"white",d3.schemeCategory10[3]]))
              .domain([0,1]);
    }
    else if (document.getElementById('color_max').value === 'blue') {
      colorScale1 = d3.scaleSequential().interpolator(d3.piecewise(d3.interpolateRgb,[d3.schemeCategory10[4],"white",d3.schemeCategory10[0]]))
              .domain([0,1]);
    }
  }




continuous("#u61", colorScale1);
        init_dt = get_point();
        point = get_point();
        g.selectAll("path").remove();
        g.selectAll("text").remove();
        g.append("g")
        .attr("class", "hexagon")
        .attr("clip-path", "url(#clip)")
        .selectAll(".hexagon")
        .data(point)
        .enter().append("path")
        .attr("d", function (d) {
          return "M" + d.x + "," + d.y + hexbin.radius(hexRadius).hexagon();
      })
           .attr("stroke", function (d,i) {
          return "#e5b367";
      })
        .attr("stroke-width", "1px")
        .attr("fill", function(d){ return colorScale1(d.cv); })
                .attr("transform","translate("+(width1)/24+","+(height1)/24+")")
        .call(_drag)
          .on('mouseover', mouseOver);

        g.append("g")
        .attr("class", "hexagon")
        .attr("clip-path", "url(#clip)")
        .selectAll("labels")
        .data(point)
        .enter()
        .append("text")
                .attr("transform","translate("+(width1)/24+","+(height1)/24+")")
          .attr("x", function(d){return d.x})
          .attr("y", function(d){return d.y})
          .text(function(d){ return d.label; })
          .attr("text-anchor", "middle")
          .attr("alignment-baseline", "central")
          .style("font-size", 10)
          .style("fill", "black");


      }

    </script>

    </div>
    <script src="{% static 'js/axure/ios.js' %}"></script>
  </body>
</html>
